# Propozitii Nostime - Quarkus Configuration

# HTTP Configuration
quarkus.http.port=${PORT:8080}
quarkus.http.host=0.0.0.0

# CORS Configuration
quarkus.http.cors=true
quarkus.http.cors.origins=https://fabian20ro.github.io
%dev.quarkus.http.cors.origins=https://fabian20ro.github.io,http://localhost:5500,http://localhost:8080
quarkus.http.cors.methods=GET,OPTIONS
quarkus.http.cors.headers=Content-Type

# Health Check
quarkus.smallrye-health.root-path=/q/health
# Disable datasource health check in prod — DB may be slow to connect on free tier cold starts
%prod.quarkus.datasource.health.enabled=false

# Logging
quarkus.log.level=INFO
quarkus.log.category."scrabble.phrases".level=DEBUG

# Datasource Configuration (Supabase PostgreSQL)
# URL/credentials use %prod profile so Dev Services can auto-provision in dev/test modes
quarkus.datasource.db-kind=postgresql
%prod.quarkus.datasource.jdbc.url=${SUPABASE_DB_URL}
%prod.quarkus.datasource.username=${SUPABASE_DB_USER:postgres}
%prod.quarkus.datasource.password=${SUPABASE_DB_PASSWORD}
%prod.quarkus.datasource.jdbc.additional-jdbc-properties.sslmode=require
quarkus.datasource.jdbc.max-size=4
quarkus.datasource.jdbc.min-size=0
quarkus.datasource.jdbc.idle-removal-interval=PT5M

# Datasource resilience (handle Supabase cold starts)
quarkus.datasource.jdbc.acquisition-timeout=60
%prod.quarkus.datasource.jdbc.new-connection-sql=SELECT 1

# Flyway Configuration
# Disabled in prod — schema already exists on Supabase; run manually if needed
%prod.quarkus.flyway.migrate-at-start=false
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.baseline-version=0
